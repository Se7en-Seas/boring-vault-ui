---
title: Solana Vault Integration
description: Tools and utilities for interacting with Boring Vault on Solana
---

## Introduction

The SDK provides Solana support for interacting with Boring Vault on the Solana blockchain. This documentation covers the functionality for retrieving vault balances and other Solana-specific interactions.

## VaultSDK

The `VaultSDK` class provides a streamlined interface for interacting with Boring Vault on Solana. 

### Initializing the SDK

To use the Solana integration, you first need to create a connection to the Solana network and initialize the SDK:

```tsx
import { createSolanaClient } from 'gill';
import { VaultSDK } from 'boring-vault-ui';

// Initialize a Solana client using gill
const rpcUrl = 'https://api.mainnet-beta.solana.com';
// You can also use moniker shortcuts like 'mainnet', 'devnet', etc.
const solanaClient = createSolanaClient({ urlOrMoniker: rpcUrl });

// Create the SDK instance
const vaultSDK = new VaultSDK(rpcUrl);
```

### Getting Vault Balances

You can retrieve the current balance of a vault using the `getVaultBalance` method:

```tsx
import { Address } from 'gill';

// The vault address
const vaultAddress = 'your_vault_address_here' as Address;

async function checkVaultBalance() {
  try {
    // Fetch the vault balance
    const balance = await vaultSDK.getVaultBalance(vaultAddress);
    console.log(`Vault balance: ${balance}`);
    return balance;
  } catch (error) {
    console.error('Error fetching vault balance:', error);
    return '0';
  }
}
```

### Getting Full Vault Data

For more comprehensive vault information, use the `getVaultData` method:

```tsx
async function getVaultInfo() {
  try {
    // Fetch the complete vault data
    const vaultData = await vaultSDK.getVaultData(vaultAddress);
    
    console.log('Vault ID:', vaultData.vaultState.vaultId.toString());
    console.log('Token Mint:', vaultData.tokenMint.toString());
    console.log('Deposit Sub-Account:', vaultData.vaultState.depositSubAccount);
    
    return vaultData;
  } catch (error) {
    console.error('Error fetching vault data:', error);
    return null;
  }
}
```

## BoringVaultSolana

The `BoringVaultSolana` class provides low-level access to the Boring Vault program on Solana.

### Creating a BoringVaultSolana Instance

```tsx
import { createBoringVaultSolana } from 'boring-vault-ui';

// Create the BoringVaultSolana instance with gill integration
const boringVault = createBoringVaultSolana({
  urlOrMoniker: 'https://api.mainnet-beta.solana.com',
  programId: 'your_program_id_here'
});
```

### Getting User Share Balances

To retrieve a user's balance of vault shares:

```tsx
async function getUserShareBalance() {
  const walletAddress = 'user_wallet_address_here';
  const vaultId = 123; // The numeric ID of the vault
  
  try {
    // Get the user's share balance in the vault
    const balanceInfo = await boringVault.getBalance(walletAddress, vaultId);
    
    console.log('Raw Balance:', balanceInfo.raw.toString());
    console.log('Formatted Balance:', balanceInfo.formatted);
    console.log('Decimals:', balanceInfo.decimals);
    
    return balanceInfo;
  } catch (error) {
    console.error('Error fetching user share balance:', error);
    return null;
  }
}
```

## Loading a Keypair

When you need to use a keypair from a Solana CLI-formatted JSON file (e.g., for testing or administrative operations):

```tsx
import { createKeyPairSignerFromPrivateKeyBytes } from 'gill';
import * as fs from 'fs';

/**
 * Load keypair from file using gill's keypair signer
 */
async function loadKeypair(keypairPath: string) {
  try {
    // Load key data using fs
    const keyData = JSON.parse(fs.readFileSync(keypairPath, 'utf-8'));
    const secretKey = new Uint8Array(keyData);
    
    // Solana keypair JSON has 64 bytes: first 32 are private key, last 32 are public key
    // Extract just the private key (first 32 bytes)
    const privateKeyBytes = secretKey.slice(0, 32);
    
    // Create keypair signer using just the private key bytes
    const keypairSigner = await createKeyPairSignerFromPrivateKeyBytes(privateKeyBytes);
    
    console.log(`Loaded keypair with address: ${keypairSigner.address}`);
    
    return keypairSigner;
  } catch (error) {
    console.error('Failed to load keypair:', error);
    throw new Error('Failed to load keypair from file');
  }
}
```

## Working with RPC Calls and Encoding

When working with the Solana RPC, it's important to use base64 encoding for account data:

```tsx
import { createSolanaClient, Address } from 'gill';

const solanaClient = createSolanaClient({ urlOrMoniker: 'mainnet' });

async function getAccountInfo(address: Address) {
  // Always use base64 encoding for account data
  const response = await solanaClient.rpc.getAccountInfo(
    address,
    { encoding: 'base64' }
  ).send();
  
  if (response.value) {
    // Extract data from the gill response
    const data = Buffer.from(response.value.data[0], 'base64');
    console.log('Account data:', data);
    return data;
  }
  
  return null;
}
```

## Complete Example

Here's a complete example showing how to check a vault's balance and a user's share in that vault:

```tsx
import { createSolanaClient, Address } from 'gill';
import { VaultSDK, createBoringVaultSolana } from 'boring-vault-ui';

async function checkVaultAndUserBalances() {
  // Initialize Solana client and SDK
  const rpcUrl = 'https://api.mainnet-beta.solana.com';
  const solanaClient = createSolanaClient({ urlOrMoniker: rpcUrl });
  const vaultSDK = new VaultSDK(rpcUrl);
  
  // Vault information
  const vaultAddress = 'your_vault_address_here' as Address;
  const vaultId = 123; // The numeric ID of the vault
  const userWallet = 'user_wallet_address_here';
  
  try {
    // 1. Get the vault balance
    const vaultBalance = await vaultSDK.getVaultBalance(vaultAddress);
    console.log(`Vault balance: ${vaultBalance}`);
    
    // 2. Get detailed vault information
    const vaultData = await vaultSDK.getVaultData(vaultAddress);
    console.log('Vault data:', vaultData);
    
    // 3. Get the user's share balance
    const boringVault = createBoringVaultSolana({
      urlOrMoniker: rpcUrl,
      programId: vaultSDK.getProgramId() // Get the program ID from the VaultSDK
    });
    
    const userShareBalance = await boringVault.getBalance(userWallet, vaultId);
    console.log(`User share balance: ${userShareBalance.formatted}`);
    
    return {
      vaultBalance,
      vaultData,
      userShareBalance
    };
  } catch (error) {
    console.error('Error checking balances:', error);
    return null;
  }
} 